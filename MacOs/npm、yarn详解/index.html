<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Npm、Yarn详解 - Blacklisten&#039;blogs</title><meta description="记录日常使用到的 npm 灬 yarn 常用命令 基本命令查看全局安装的包 bash zsh12npm list -g --depth 0yarn global list --depth 0  检测可以更新的包可选择性更新 bash zsh1234npm install npm-check -gnpm-check -uyarn upgrade-interactive"><meta property="og:type" content="blog"><meta property="og:title" content="Npm、Yarn详解"><meta property="og:url" content="https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/"><meta property="og:site_name" content="Blacklisten&#039;blogs"><meta property="og:description" content="记录日常使用到的 npm 灬 yarn 常用命令 基本命令查看全局安装的包 bash zsh12npm list -g --depth 0yarn global list --depth 0  检测可以更新的包可选择性更新 bash zsh1234npm install npm-check -gnpm-check -uyarn upgrade-interactive"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.blacklisten.cn/gallery/covers/DD%20Vector%20Landscape%20Scene%2065463.svg"><meta property="article:published_time" content="2021-01-14T13:55:06.000Z"><meta property="article:author" content="blacklisten"><meta property="article:tag" content="MacOs M1"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/covers/DD%20Vector%20Landscape%20Scene%2065463.svg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/"},"headline":"Blacklisten'blogs","image":[],"datePublished":"2021-01-14T13:55:06.000Z","author":{"@type":"Person","name":"blacklisten"},"description":"记录日常使用到的 npm 灬 yarn 常用命令 基本命令查看全局安装的包 bash zsh12npm list -g --depth 0yarn global list --depth 0  检测可以更新的包可选择性更新 bash zsh1234npm install npm-check -gnpm-check -uyarn upgrade-interactive"}</script><link rel="canonical" href="https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/github.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?68ab0f2c8b23735e70a585f85d89b4d3";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-117852294-3" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-117852294-3');</script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Blacklisten'blogs" type="application/atom+xml">
</head><body class="is-3-column white"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Blacklisten</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="My Github" href="https://github.com/blacklisten"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/gallery/covers/DD%20Vector%20Landscape%20Scene%2065463.svg" alt="Npm、Yarn详解"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2021-01-14</time></span><span class="level-item"><a class="link-muted" href="/categories/MacOs/">MacOs</a></span><span class="level-item">22 分钟读完 (大约3367个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Npm、Yarn详解</h1><div class="content"><p>记录日常使用到的 npm 灬 yarn 常用命令</p>
<h2 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h2><p><strong>查看全局安装的包</strong></p>
<figure class="highlight zsh"><figcaption><span>bash zsh</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm list -g --depth 0</span><br><span class="line">yarn global list --depth 0</span><br></pre></td></tr></tbody></table></figure>

<p><strong>检测可以更新的包</strong><br>可选择性更新</p>
<figure class="highlight zsh"><figcaption><span>bash zsh</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install npm-check -g</span><br><span class="line">npm-check -u</span><br><span class="line"></span><br><span class="line">yarn upgrade-interactive</span><br></pre></td></tr></tbody></table></figure>

<a id="more"></a>

<figure class="highlight zsh"><figcaption><span>bash zsh</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install npm-check-updates -g</span><br><span class="line">ncu // 检测当前项目中可用的更新</span><br><span class="line">ncu -u // 更新当前项目package.json中可更新包到最新版本，之后执行npm install就可以直接更新掉了</span><br><span class="line">ncu -g // 检测全局可用更新</span><br></pre></td></tr></tbody></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/npm-check">npm-check</a><br><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/npm-check-updates">npm-check-updates</a></p>
<p><strong>查看当前包命名是否被使用</strong></p>
<figure class="highlight bash"><figcaption><span>bash zsh</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm view &lt;packageName&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>被使用则会返回当前使用此名称包的信息，<strong>404</strong>代表未被使用</p>
<p><strong>查看包版本</strong></p>
<figure class="highlight bash"><figcaption><span>bash zsh</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm view &lt;packageName&gt; version <span class="comment"># 查看某个模块的最新版本</span></span><br><span class="line">npm view &lt;packageName&gt; versions <span class="comment"># 查看某个模块的所有历史版本</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="package-json详解"><a href="#package-json详解" class="headerlink" title="package.json详解"></a>package.json详解</h2><p>如果你使用过 <code>Nodejs</code> ，则可能会遇到 <strong>package.json</strong> 文件。它是一个 <code>JSON</code> 文件，位于项目根目录。你的 <strong>package.json</strong> 包含关于项目的重要信息。它包含关于项目的使人类可读元数据（如项目名称和说明）以及功能元数据（如程序包版本号和程序所需的依赖项列表）。</p>
<article class="message is-info"><div class="message-body">
<p>每个字段的含义可查看<a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v7/configuring-npm/package-json">官方文档</a></p>
</div></article>

<p><strong>package.json</strong> 示例如下所示：</p>
<figure class="highlight json"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"my-project"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.5.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"Express server project using compression"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"src/index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: {</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"node index.js"</span>,</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"nodemon"</span>,</span><br><span class="line">    <span class="attr">"lint"</span>: <span class="string">"eslint **/*.js"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="attr">"dependencies"</span>: {</span><br><span class="line">    <span class="attr">"express"</span>: <span class="string">"^4.16.4"</span>,</span><br><span class="line">    <span class="attr">"compression"</span>: <span class="string">"~1.7.4"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="attr">"devDependencies"</span>: {</span><br><span class="line">    <span class="attr">"eslint"</span>: <span class="string">"^5.16.0"</span>,</span><br><span class="line">    <span class="attr">"nodemon"</span>: <span class="string">"^1.18.11"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="attr">"repository"</span>: {</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://github.com/osiolabs/example.git"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"Jon Church"</span>,</span><br><span class="line">  <span class="attr">"contributors"</span>: [{</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"Amber Matz"</span>,</span><br><span class="line">    <span class="attr">"email"</span>: <span class="string">"example@example.com"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://www.osiolabs.com/#team"</span></span><br><span class="line">  }],</span><br><span class="line">  <span class="attr">"keywords"</span>: [<span class="string">"server"</span>, <span class="string">"osiolabs"</span>, <span class="string">"express"</span>, <span class="string">"compression"</span>]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="package-json-的用途是什么？"><a href="#package-json-的用途是什么？" class="headerlink" title="package.json 的用途是什么？"></a>package.json 的用途是什么？</h3><p>项目的 <strong>package.json</strong> 是配置和描述如何与程序交互和运行的中心。 <strong>npm CLI</strong>（和 <strong>yarn</strong>）用它来识别你的项目并了解如何处理项目的依赖关系。<strong>package.json</strong> 文件使 <strong>npm</strong> 可以启动你的项目、运行脚本、安装依赖项、发布到 <strong>NPM</strong> 注册表以及许多其他有用的任务。 <strong>npm CLI</strong> 也是管理 <strong>package.json</strong> 的最佳方法，因为它有助于在项目的整个生命周期内生成和更新 <strong>package.json</strong> 文件。</p>
<p><strong>package.json</strong> 会在项目的生命周期中扮演多个角色，其中某些角色仅适用于发布到 <strong>NPM</strong> 的软件包。即使你没有把项目发布到 <strong>NPM</strong> 注册表中，或者没有将其公开发布给其他人，那么 <strong>package.json</strong> 对于开发流程仍然至关重要。</p>
<p>你的项目还必须包含 <strong>package.json</strong>，然后才能从 <strong>NPM</strong> 安装软件包。这可能是你在项目中需要它的主要原因之一。</p>
<h3 id="package-json-中的常见字段"><a href="#package-json-中的常见字段" class="headerlink" title="package.json 中的常见字段"></a>package.json 中的常见字段</h3><ul>
<li><p><strong>name</strong><br><strong><code>name</code> 字段定义包的名称</strong>。发布到 NPM 注册表时，这是软件包将在其中显示的名称。它不能超过 <strong>214</strong> 个字符，只能是小写字母，并且必须是URL安全的（允许连字符和下划线，但 URL 中不允许使用空格或其他字符）。</p>
<p><strong>如果将软件包发布到 NPM，则 <code>name</code> 属性是必需的</strong>，并且必须是唯一的。如果尝试用 NPM 注册表上当前已经使用的名称发布程序包，则会收到错误消息。如果你的软件包并不是要发布到 NPM 上，则 <code>name</code> 不必是唯一的。</p>
</li>
<li><p><strong>version</strong><br><code>version</code> 字段对于任何已发布的软件包都非常重要，并且在发布之前是必填的。这是 package.json 描述的软件的当前版本。</p>
<p>通常情况下我们并不需要使用 <a target="_blank" rel="noopener" href="https://docs.npmjs.com/about-semantic-versioning">Semver</a> 来管控版本，通常在将新版本发布到 NPM 之前，根据 <code>SemVer</code>，版本号会增加。<a target="_blank" rel="noopener" href="https://heynode.com/tutorial/how-use-semantic-versioning-npm">了解有关语义版本控制（semantic versioning）的更多信息</a>。</p>
<ul>
<li>补丁版本 ~1.0.4</li>
<li>次要版本 ^1.0.4</li>
<li>正式版本 1.0.4</li>
</ul>
<table>
<thead>
<tr>
<th>代码状态</th>
<th>阶段</th>
<th>规则</th>
<th>示例版本</th>
</tr>
</thead>
<tbody><tr>
<td>初版</td>
<td>新产品</td>
<td>从1.0.0开始</td>
<td>1.0.0</td>
</tr>
<tr>
<td>向后兼容的错误修复</td>
<td>补丁发布</td>
<td>递增第三位数</td>
<td>1.0.1</td>
</tr>
<tr>
<td>向后兼容的新功能</td>
<td>轻微释放</td>
<td>递增中间数字并将最后一位重置为零</td>
<td>1.1.0</td>
</tr>
<tr>
<td>更改会破坏向后兼容性</td>
<td>主要发行</td>
<td>递增第一位并将中间和最后一位重置为零</td>
<td>2.0.0</td>
</tr>
</tbody></table>
</li>
<li><p><strong>license</strong><br>这是非常重要但经常被忽略的属性。<code>license</code> 字段使我们可以定义适用于 package.json 所描述代码的许可证。同样，在将项目发布到 NPM 注册表时，这非常重要，因为许可证可能会限制某些开发人员或组织对软件的使用。拥有清晰的许可证有助于明确定义该软件可以使用的术语。</p>
<p><code>license</code> 字段的值通常是许可证的标识符代码——例如 <strong>MIT</strong> 或 <strong>ISC</strong> 之类的字符串，它们代表<a target="_blank" rel="noopener" href="https://opensource.org/licenses/MIT">MIT</a> 许可证和 <a target="_blank" rel="noopener" href="https://opensource.org/licenses/ISC">ISC</a> 许可证。如果你不想提供许可证，或者明确不想授予使用私有或未发布的软件包的权限，则可以将 <code>UNLICENSED</code> 作为许可证。如果你不确定要使用哪个许可证， <a target="_blank" rel="noopener" href="https://choosealicense.com/">Choose a License</a> 是对你有用的资源。</p>
</li>
<li><p><strong>author 和 contributors</strong><br><code>author</code> 和 <code>contributors</code> 字段的功能类似。它们都是 people 字段，可以是”Name” 格式的字符串，也可以是具有 <strong>name，email，url</strong> 字段的对象。email 和 url 都是可选的。</p>
<p><em>author 只供一个人使用，contributors 则可以由多个人组成。</em></p>
</li>
<li><p><strong>description</strong><br>NPM 注册表将 <code>description</code> 字段用于发布的软件包，以在搜索结果中和 <a target="_blank" rel="noopener" href="https://www.npmjs.com/">npmjs.com</a> 网站上描述该软件包。</p>
<p>当用户搜索 NPM 注册表时，该字符串用于帮助了解软件包。这应该是软件包的简短摘要。</p>
<p>即使你没有将其发布到 NPM 注册表中，它也可以用作项目的简单文档。</p>
</li>
<li><p><strong>keywords</strong><br><code>keywords</code> 字段是一个字符串数组，其作用与描述相似。 NPM 注册表会为该字段建立索引，能够在有人搜索软件包时帮助找到它们。数组中的每个值都是与你的程序包关联的一个关键字。</p>
<p>如果你不发布到 NPM 注册表，则这个字段用处不大，可以忽略它。</p>
</li>
<li><p><strong>main</strong><br><code>main</code> 字段是 package.json 的功能属性。它定义了项目的入口点，通常是用于启动项目的文件。</p>
<p>如果你的包（例如其名称为 foo-lib）是由用户安装的，则当用户执行 require(‘foo-lib’) 时，这是 require 返回的 <code>main</code> 字段中所列出的文件的 module.exports 属性。</p>
</li>
<li><p><strong>repository</strong><br>你可以通过提供 <code>repository</code> 字段来记录项目代码所在的资源库。该字段是一个对象，用于定义源代码所在的 url 及其使用的版本控制系统的类型。对于开源项目，可能是以 Git 作为版本控制系统的 GitHub 或 Bitbucket 。</p>
<p><em>需要注意的是 URL 字段的本意是指向可从中访问版本控制的位置，而不仅仅是指向已发布的代码库。</em></p>
</li>
<li><p><strong>dependencies</strong><br>这是 package.json 中最重要的字段之一，它列出了项目使用的所有依赖项（项目所依赖的外部代码）。使用 npm CLI 安装软件包时，它将下载到你的 node_modules/ 文件夹中，并将一个条目添加到你的依赖项属性中，注意软件包的名称和已安装的版本。</p>
</li>
<li><p><strong>devDependencies</strong><br>与 dependencies 字段类似，但是这里列出的包仅在开发期间需要，而在生产中不需要。</p>
</li>
<li><p><strong>private</strong><br>一般公司的非开源项目，都会设置 private 属性的值为 true，这是因为 npm 拒绝发布私有模块，通过设置该字段可以防止私有模块被无意间发布出去</p>
</li>
<li><p><strong>files</strong><br>发布哪些文件到 npm 上</p>
</li>
</ul>
<h3 id="package-json-中不常见字段"><a href="#package-json-中不常见字段" class="headerlink" title="package.json 中不常见字段"></a>package.json 中不常见字段</h3><ul>
<li><p><strong>指定模块适用系统（os）</strong><br>假如我们开发了一个模块，只能跑在 darwin 系统下，我们需要保证 windows 用户不会安装到该模块，从而避免发生不必要的错误。<br>这时候，使用 <code>os</code> 属性则可以帮助我们实现以上的需求，该属性可以指定模块适用系统的系统，或者指定不能安装的系统黑名单（当在系统黑名单中的系统中安装模块则会报错）</p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">"os" : [ "darwin", "linux" ] # 适用系统</span><br><span class="line">"os" : [ "!win32" ] # 黑名单</span><br></pre></td></tr></tbody></table></figure>
<article class="message is-info"><div class="message-body">
<p>Tips：在 node 环境下可以使用 <code>process.platform</code> 来判断操作系统。</p>
</div></article></li>
<li><p><strong>指定模块适用 cpu 架构（cpu）</strong><br>上面的 os 字段类似，我们可以用 <code>cpu</code> 字段更精准的限制用户安装环境：</p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">"cpu" : [ "x64", "ia32" ] # 适用 cpu</span><br><span class="line">"cpu" : [ "!arm", "!mips" ] # 黑名单</span><br></pre></td></tr></tbody></table></figure>
<article class="message is-info"><div class="message-body">
<p>Tips：在 node 环境下可以使用 <code>process.arch</code> 来判断 cpu 架构。</p>
</div></article></li>
<li><p><strong>指定项目 node 版本（engines）</strong><br>有时候，新拉一个项目的时候，由于和其他开发使用的 node 版本不同，导致会出现很多奇奇怪怪的问题（如某些依赖安装报错、依赖安装完项目跑步起来等）。</p>
<p>为了实现项目开箱即用的伟大理想，这时候可以使用 package.json 的 <code>engines</code> 字段来指定项目 node 版本</p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"engines": {</span><br><span class="line">  "node": "&gt;= 8.16.0"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>该字段也可以指定适用的 npm 版本</strong></p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"engines": {</span><br><span class="line">  "npm": "&gt;= 6.9.0"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<article class="message is-warning"><div class="message-body">
<p>需要注意的是，<code>engines</code> 属性仅起到一个说明的作用，当用户版本不符合指定值时也不影响依赖的安装。</p>
</div></article></li>
<li><p><strong>自定义命令（bin）</strong><br>用过 vue-cli，create-react-app等脚手架的朋友们，不知道你们有没有好奇过，为什么安装这些脚手架后，就可以使用类似 vue create/create-react-app之类的命令，其实这和 package.json 中的 <code>bin</code> 字段有关。</p>
<p><code>bin</code> 字段用来指定各个内部命令对应的可执行文件的位置。当package.json 提供了 <code>bin</code> 字段后，即相当于做了一个命令名和本地文件名的映射。<br>当用户安装带有 <code>bin</code> 字段的包时</p>
<p>如果是全局安装，npm 将会使用符号链接把这些文件链接到/usr/local/node_modules/.bin/；<br>如果是本地安装，会链接到./node_modules/.bin/。</p>
<p>举个 🌰，如果要使用 my-app-cli 作为命令时，可以配置以下 <code>bin</code> 字段</p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"bin": {</span><br><span class="line">  "my-app-cli": "./bin/cli.js"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>上面代码指定，my-app-cli 命令对应的可执行文件为 <code>bin</code> 子目录下的 cli.js，因此在安装了 <code>my-app-cli</code> 包的项目中，就可以很方便地利用 npm执行脚本</p>
<figure class="highlight"><figcaption><span>package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": {</span><br><span class="line">  start: 'node node_modules/.bin/my-app-cli'</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>咦，怎么看起来和 vue create/create-react-app之类的命令不太像？原因：</p>
<p>当需要 node 环境时就需要加上 node 前缀<br>如果加上 node 前缀，就需要指定 my-app-cli 的路径 -&gt; node_modules/.bin，否则 node <code>my-app-cli</code> 会去查找当前路径下的 <strong>my-app-cli.js</strong>，这样肯定是不对。</p>
<p>若要实现像 vue create/create-react-app之类的命令一样简便的方式，<strong>则可以在上文提到的 bin 子目录下可执行文件cli.js 中的第一行写入以下命令</strong></p>
<figure class="highlight js"><figcaption><span>cli.js</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br></pre></td></tr></tbody></table></figure>
<p>这行命令的作用是告诉系统用 node 解析，这样命令就可以简写成 <code>my-app-cli</code> 了。</p>
</li>
<li><p><strong>peerDependencies</strong><br>packageA packageB 同时依赖 vue 时，使用 <code>peerDependencies</code> 就可以很好的管理依赖，如果我们使用 <code>dependencies</code> 依赖树就会是这个样子</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── package</span><br><span class="line">│   └── node_modules</span><br><span class="line">│       ├── vue</span><br><span class="line">│       ├── packageA</span><br><span class="line">│       │   └── nodule_modules</span><br><span class="line">│       │       └── vue</span><br><span class="line">│       └── packageB</span><br><span class="line">│       │   └── nodule_modules</span><br><span class="line">│       │       └── vue</span><br></pre></td></tr></tbody></table></figure>
<p>而 <code>peerDependencies</code> 就可以避免类似的核心依赖库被重复下载的问题。</p>
<p>如果在 packageA 和 packageB 的 package.json 中使用 <code>peerDependencies</code> 来声明核心依赖库，例如：</p>
<figure class="highlight json"><figcaption><span>packageA package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">"peerDependencies"</span>: {</span><br><span class="line">    <span class="attr">"vue"</span>: <span class="string">"3.0.1"</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight json"><figcaption><span>packageB package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">"peerDependencies"</span>: {</span><br><span class="line">    <span class="attr">"vue"</span>: <span class="string">"3.0.1"</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight json"><figcaption><span>package package.json</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="attr">"dependencies"</span>: {</span><br><span class="line">    <span class="attr">"vue"</span>: <span class="string">"3.0.1"</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>此时在主系统中执行 <code>$ npm install</code> 生成的依赖图就是这样的：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── package</span><br><span class="line">│   └── node_modules</span><br><span class="line">│       ├── vue</span><br><span class="line">│       ├── packageA</span><br><span class="line">│       └── packageB</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h2 id="其它资料"><a href="#其它资料" class="headerlink" title="其它资料"></a>其它资料</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000009546913">用 husky 和 lint-staged 构建超溜的代码检查工作流</a></p>
<br>

<article class="message message-immersive is-warning">
<div class="message-body">
<i class="fas fa-question-circle mr-2"></i>Something wrong with this article? 
Click <a target="_blank" rel="noopener" href="https://github.com/blacklisten/nblogs/edit/site/source/_posts/2021/Npm-Yarn-Help.md">here</a> 
to submit your revision.
</div>
</article>

<p><a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-size:12px;line-height:1.2;display:inline-block;border-radius:3px" href="https://www.vecteezy.com/free-vector/vector-landscape" target="_blank" rel="noopener noreferrer" title="Vector Landscape Vectors by Vecteezy"><span style="display:inline-block;padding:2px 3px"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-1px;fill:white" viewBox="0 0 32 32"><path d="M20.8 18.1c0 2.7-2.2 4.8-4.8 4.8s-4.8-2.1-4.8-4.8c0-2.7 2.2-4.8 4.8-4.8 2.7.1 4.8 2.2 4.8 4.8zm11.2-7.4v14.9c0 2.3-1.9 4.3-4.3 4.3h-23.4c-2.4 0-4.3-1.9-4.3-4.3v-15c0-2.3 1.9-4.3 4.3-4.3h3.7l.8-2.3c.4-1.1 1.7-2 2.9-2h8.6c1.2 0 2.5.9 2.9 2l.8 2.4h3.7c2.4 0 4.3 1.9 4.3 4.3zm-8.6 7.5c0-4.1-3.3-7.5-7.5-7.5-4.1 0-7.5 3.4-7.5 7.5s3.3 7.5 7.5 7.5c4.2-.1 7.5-3.4 7.5-7.5z"></path></svg></span><span style="display:inline-block;padding:2px 3px">Vector Landscape Vectors by Vecteezy</span></a></p>
<script>
        document.querySelectorAll('.not-gallery-item')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="article-licensing box"><div class="licensing-title"><p>Npm、Yarn详解</p><p><a href="https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/">https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>blacklisten</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-01-14</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/MacOs-M1/">MacOs M1</a></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.jpg" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Learning/%E6%B5%85%E8%B0%88%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">浅谈单点登录</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/MacOs/macos-%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95%E4%BB%A5%E5%8F%8A%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%9A%84%E6%8A%80%E5%B7%A7/"><span class="level-item">Macos 使用问题记录以及一些简单的技巧</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqusjs.css"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqus.js"></script><script>new DisqusJS({
            shortname: 'blacklisten',
            apikey: "exTu1A9AwH0nVWvvCmSVh7H8HoTp4RUkld2NgMecCw2aYahA3g7iDtzNCxP7Quug",
            siteName: "Blacklisten'blogs",
            identifier: 'MacOs/npm、yarn详解/',
            url: 'https://www.blacklisten.cn/MacOs/npm%E3%80%81yarn%E8%AF%A6%E8%A7%A3/',
            title: "Npm、Yarn详解",
            api: 'https://disqus.skk.moe/disqus/',
            admin: "blacklisten",
            adminLabel: "Admin",
            nesting: 4
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex" href="#基本命令"><span class="mr-2">1</span><span>基本命令</span></a></li><li><a class="is-flex" href="#package-json详解"><span class="mr-2">2</span><span>package.json详解</span></a><ul class="menu-list"><li><a class="is-flex" href="#package-json-的用途是什么？"><span class="mr-2">2.1</span><span>package.json 的用途是什么？</span></a></li><li><a class="is-flex" href="#package-json-中的常见字段"><span class="mr-2">2.2</span><span>package.json 中的常见字段</span></a></li><li><a class="is-flex" href="#package-json-中不常见字段"><span class="mr-2">2.3</span><span>package.json 中不常见字段</span></a></li></ul></li><li><a class="is-flex" href="#其它资料"><span class="mr-2">3</span><span>其它资料</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Blacklisten</a><p class="size-small"><span>&copy; 2021 blacklisten</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="My GitHub" href="https://github.com/blacklisten"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script src="/js/imaegoo/universe.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><!-- hexo injector body_end start -->
    <script>
    (() => {
        function switchTab() {
            if (!location.hash) {
              return;
            }
            Array
                .from(document.querySelectorAll('.tab-content'))
                .forEach($tab => {
                    $tab.classList.add('is-hidden');
                });
            Array
                .from(document.querySelectorAll('.tabs li'))
                .forEach($tab => {
                    $tab.classList.remove('is-active');
                });
            const $activeTab = document.querySelector(location.hash);
            if ($activeTab) {
                $activeTab.classList.remove('is-hidden');
            }
            const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
            if ($tabMenu) {
                $tabMenu.parentElement.classList.add('is-active');
            }
        }
        switchTab();
        window.addEventListener('hashchange', switchTab, false);
    })();
    </script>
    <!-- hexo injector body_end end --></body></html>